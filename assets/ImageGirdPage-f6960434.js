import{v as W,r as V,d as j,z as P,T as S,b,D as _,A as d,G as N,F as g,E as c,U as O,u as m,R as E,L as u,B as p,P as k,Q as U,S as I,N as z,O as M}from"./@vue-9cc5f714.js";import{u as X}from"./ToolStore-5535fb91.js";import{_ as Y}from"./plugin-vueexport-helper-c27b6911.js";import"./pinia-486f5c51.js";import"./lodash-ef160764.js";import"./crypto-js-4677913a.js";const h=f=>(z("data-v-203a2006"),f=f(),M(),f),F=h(()=>u("label",null,"行数：",-1)),A=h(()=>u("label",null,"列数：",-1)),D=h(()=>u("label",null,"宽：",-1)),Q=h(()=>u("label",null,"长：",-1)),q={class:"image-gird"},J={class:"image-row"},K=["onClick"],Z=["src"],ee={class:"image-preview"},te=["src"],oe=W({__name:"ImageGirdPage",setup(f){const G=V(),C=V(),t=X(),n=j({cells:[],cellX:void 0,cellY:void 0}),x=(i,e)=>{const o=n.cells[e];return o?o[i]:null},v=(i,e)=>{var o,l,r,a;(l=(o=G.value)==null?void 0:o.$el)==null||l.style.setProperty("--cell-width",`${i}px`),(a=(r=G.value)==null?void 0:r.$el)==null||a.style.setProperty("--cell-height",`${e}px`)},w=(i,e)=>{const o=[];for(let l=0;l<i;++l){const r=[];for(let a=0;a<e;++a)r.push(x(a,l));o.push(r)}n.cells=o};P(()=>{w(t.imageGird.rowCount,t.imageGird.columnCount)}),S(()=>{v(t.imageGird.imageWidth,t.imageGird.imageHeight)}),b(()=>[t.imageGird.rowCount,t.imageGird.columnCount],([i,e])=>{w(i,e)}),b(()=>[t.imageGird.imageWidth,t.imageGird.imageHeight],([i,e])=>{v(i,e)});const L=(i,e)=>{var o;n.cellX=i,n.cellY=e,(o=C.value)==null||o.click()},R=()=>{const i=document.createElement("canvas");i.width=t.imageGird.imageWidth*t.imageGird.columnCount,i.height=t.imageGird.imageHeight*t.imageGird.rowCount;const e=i.getContext("2d");for(let o=0;o<t.imageGird.rowCount;++o)for(let l=0;l<t.imageGird.columnCount;++l){const r=n.cells[o][l];if(r){const a=document.createElement("img");a.src=r,e==null||e.drawImage(a,0,0,a.width,a.height,l*t.imageGird.imageWidth,o*t.imageGird.imageHeight,t.imageGird.imageWidth,t.imageGird.imageHeight)}}i.toBlob(o=>{n.imageTarget&&URL.revokeObjectURL(n.imageTarget),n.imageTarget=URL.createObjectURL(o)},"image/png",.9)},$=i=>{const e=i.target,o=e.files[0],l=n.cellX??0,r=n.cellY??0,a=n.cells[r][l];e.value="",a&&URL.revokeObjectURL(a),n.cells[r][l]=URL.createObjectURL(o)};return(i,e)=>{const o=_("pc-form-number-input"),l=_("pc-form-row"),r=_("pc-form-text-button"),a=_("pc-form-sheet"),T=_("pc-center-part-layout");return d(),N(T,{ref_key:"$el",ref:G,class:"pc-image-gird-page"},{default:g(()=>[c(a,{class:"image-info-pane",onSubmit:e[4]||(e[4]=O(()=>{},["prevent"]))},{default:g(()=>[c(l,null,{default:g(()=>[F,c(o,{modelValue:m(t).imageGird.rowCount,"onUpdate:modelValue":e[0]||(e[0]=s=>m(t).imageGird.rowCount=s),precision:0},null,8,["modelValue"]),A,c(o,{modelValue:m(t).imageGird.columnCount,"onUpdate:modelValue":e[1]||(e[1]=s=>m(t).imageGird.columnCount=s),precision:0},null,8,["modelValue"])]),_:1}),c(l,null,{default:g(()=>[D,c(o,{modelValue:m(t).imageGird.imageWidth,"onUpdate:modelValue":e[2]||(e[2]=s=>m(t).imageGird.imageWidth=s),precision:0},null,8,["modelValue"]),Q,c(o,{modelValue:m(t).imageGird.imageHeight,"onUpdate:modelValue":e[3]||(e[3]=s=>m(t).imageGird.imageHeight=s),precision:0},null,8,["modelValue"])]),_:1}),c(l,null,{default:g(()=>[c(r,{onClick:R},{default:g(()=>[E("生成")]),_:1})]),_:1})]),_:1}),u("div",q,[(d(!0),p(k,null,U(n.cells,(s,B)=>(d(),p("div",J,[(d(!0),p(k,null,U(s,(y,H)=>(d(),p("div",{class:"image-cell",onClick:ie=>L(H,B)},[y?(d(),p("img",{key:0,src:y},null,8,Z)):I("",!0)],8,K))),256))]))),256)),u("input",{ref_key:"$cellInput",ref:C,accept:"image/*",type:"file",onInput:$,style:{display:"none"}},null,544)]),u("div",ee,[n.imageTarget?(d(),p("img",{key:0,class:"image-target",alt:"target",src:n.imageTarget},null,8,te)):I("",!0)])]),_:1},512)}}});const me=Y(oe,[["__scopeId","data-v-203a2006"]]);export{me as default};
