import{u as P}from"./ToolStore-9fcf4a42.js";import T from"./CenterPartPage-7f9607d7.js";import{d as W,j as V,r as B,n as N,C as O,D as k,b as f,f as d,e as S,w as u,z as m,x as c,y as z,g,q as _,v as y,F as x,A as I,p as E,h as X}from"./index-71d585f3.js";import{_ as Y}from"./plugin-vueexport-helper-c27b6911.js";const h=p=>(E("data-v-9f5b2442"),p=p(),X(),p),F=h(()=>g("label",null,"行数：",-1)),M=h(()=>g("label",null,"列数：",-1)),q=h(()=>g("label",null,"宽：",-1)),A=h(()=>g("label",null,"长：",-1)),D={class:"image-gird"},J={class:"image-row"},K=["onClick"],Q=["src"],Z={class:"image-preview"},ee=["src"],te=W({__name:"ImageGirdPage",setup(p){const G=V(),C=V(),t=P(),n=B({cells:[],cellX:void 0,cellY:void 0}),U=(l,e)=>{const o=n.cells[e];return o?o[l]:null},v=(l,e)=>{var o,i,r,a;(i=(o=G.value)==null?void 0:o.$el)==null||i.style.setProperty("--cell-width",`${l}px`),(a=(r=G.value)==null?void 0:r.$el)==null||a.style.setProperty("--cell-height",`${e}px`)},w=(l,e)=>{const o=[];for(let i=0;i<l;++i){const r=[];for(let a=0;a<e;++a)r.push(U(a,i));o.push(r)}n.cells=o};N(()=>{w(t.imageGird.rowCount,t.imageGird.columnCount)}),O(()=>{v(t.imageGird.imageWidth,t.imageGird.imageHeight)}),k(()=>[t.imageGird.rowCount,t.imageGird.columnCount],([l,e])=>{w(l,e)}),k(()=>[t.imageGird.imageWidth,t.imageGird.imageHeight],([l,e])=>{v(l,e)});const L=(l,e)=>{var o;n.cellX=l,n.cellY=e,(o=C.value)==null||o.click()},$=()=>{const l=document.createElement("canvas");l.width=t.imageGird.imageWidth*t.imageGird.columnCount,l.height=t.imageGird.imageHeight*t.imageGird.rowCount;const e=l.getContext("2d");for(let o=0;o<t.imageGird.rowCount;++o)for(let i=0;i<t.imageGird.columnCount;++i){const r=n.cells[o][i];if(r){const a=document.createElement("img");a.src=r,e==null||e.drawImage(a,0,0,a.width,a.height,i*t.imageGird.imageWidth,o*t.imageGird.imageHeight,t.imageGird.imageWidth,t.imageGird.imageHeight)}}l.toBlob(o=>{n.imageTarget&&URL.revokeObjectURL(n.imageTarget),n.imageTarget=URL.createObjectURL(o)},"image/png",.9)},R=l=>{const e=l.target,o=e.files[0],i=n.cellX??0,r=n.cellY??0,a=n.cells[r][i];e.value="",a&&URL.revokeObjectURL(a),n.cells[r][i]=URL.createObjectURL(o)};return(l,e)=>{const o=f("form-number-input"),i=f("form-row"),r=f("form-text-button"),a=f("form-sheet");return d(),S(T,{ref_key:"$el",ref:G,class:"image-gird-page"},{default:u(()=>[m(a,{class:"image-info-pane"},{default:u(()=>[m(i,null,{default:u(()=>[F,m(o,{modelValue:c(t).imageGird.rowCount,"onUpdate:modelValue":e[0]||(e[0]=s=>c(t).imageGird.rowCount=s),precision:0},null,8,["modelValue"]),M,m(o,{modelValue:c(t).imageGird.columnCount,"onUpdate:modelValue":e[1]||(e[1]=s=>c(t).imageGird.columnCount=s),precision:0},null,8,["modelValue"])]),_:1}),m(i,null,{default:u(()=>[q,m(o,{modelValue:c(t).imageGird.imageWidth,"onUpdate:modelValue":e[2]||(e[2]=s=>c(t).imageGird.imageWidth=s),precision:0},null,8,["modelValue"]),A,m(o,{modelValue:c(t).imageGird.imageHeight,"onUpdate:modelValue":e[3]||(e[3]=s=>c(t).imageGird.imageHeight=s),precision:0},null,8,["modelValue"])]),_:1}),m(i,null,{default:u(()=>[m(r,{onClick:$},{default:u(()=>[z("生成")]),_:1})]),_:1})]),_:1}),g("div",D,[(d(!0),_(x,null,y(n.cells,(s,j)=>(d(),_("div",J,[(d(!0),_(x,null,y(s,(b,H)=>(d(),_("div",{class:"image-cell",onClick:oe=>L(H,j)},[b?(d(),_("img",{key:0,src:b},null,8,Q)):I("",!0)],8,K))),256))]))),256)),g("input",{ref_key:"$cellInput",ref:C,accept:"image/*",type:"file",onInput:R,style:{display:"none"}},null,544)]),g("div",Z,[n.imageTarget?(d(),_("img",{key:0,class:"image-target",alt:"target",src:n.imageTarget},null,8,ee)):I("",!0)])]),_:1},512)}}});const re=Y(te,[["__scopeId","data-v-9f5b2442"]]);export{re as default};
