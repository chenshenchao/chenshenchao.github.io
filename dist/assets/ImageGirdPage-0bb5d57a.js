import{d as P,j as b,r as T,n as W,C as B,D as k,b as f,f as c,e as S,w as u,q as m,y as d,z as E,E as N,g,v as p,x as y,F as x,A as I,p as O,h as z}from"./index-2a4d07a8.js";import{u as M}from"./ToolStore-9ce1ab68.js";import X from"./CenterPartPage-430729cd.js";import{_ as Y}from"./plugin-vueexport-helper-c27b6911.js";const h=_=>(O("data-v-6dfdf5c4"),_=_(),z(),_),F=h(()=>g("label",null,"行数：",-1)),q=h(()=>g("label",null,"列数：",-1)),A=h(()=>g("label",null,"宽：",-1)),D=h(()=>g("label",null,"长：",-1)),J={class:"image-gird"},K={class:"image-row"},Q=["onClick"],Z=["src"],ee={class:"image-preview"},te=["src"],oe=P({__name:"ImageGirdPage",setup(_){const G=b(),C=b(),t=M(),n=T({cells:[],cellX:void 0,cellY:void 0}),U=(i,e)=>{const o=n.cells[e];return o?o[i]:null},v=(i,e)=>{var o,l,r,a;(l=(o=G.value)==null?void 0:o.$el)==null||l.style.setProperty("--cell-width",`${i}px`),(a=(r=G.value)==null?void 0:r.$el)==null||a.style.setProperty("--cell-height",`${e}px`)},w=(i,e)=>{const o=[];for(let l=0;l<i;++l){const r=[];for(let a=0;a<e;++a)r.push(U(a,l));o.push(r)}n.cells=o};W(()=>{w(t.imageGird.rowCount,t.imageGird.columnCount)}),B(()=>{v(t.imageGird.imageWidth,t.imageGird.imageHeight)}),k(()=>[t.imageGird.rowCount,t.imageGird.columnCount],([i,e])=>{w(i,e)}),k(()=>[t.imageGird.imageWidth,t.imageGird.imageHeight],([i,e])=>{v(i,e)});const L=(i,e)=>{var o;n.cellX=i,n.cellY=e,(o=C.value)==null||o.click()},$=()=>{const i=document.createElement("canvas");i.width=t.imageGird.imageWidth*t.imageGird.columnCount,i.height=t.imageGird.imageHeight*t.imageGird.rowCount;const e=i.getContext("2d");for(let o=0;o<t.imageGird.rowCount;++o)for(let l=0;l<t.imageGird.columnCount;++l){const r=n.cells[o][l];if(r){const a=document.createElement("img");a.src=r,e==null||e.drawImage(a,0,0,a.width,a.height,l*t.imageGird.imageWidth,o*t.imageGird.imageHeight,t.imageGird.imageWidth,t.imageGird.imageHeight)}}i.toBlob(o=>{n.imageTarget&&URL.revokeObjectURL(n.imageTarget),n.imageTarget=URL.createObjectURL(o)},"image/png",.9)},R=i=>{const e=i.target,o=e.files[0],l=n.cellX??0,r=n.cellY??0,a=n.cells[r][l];e.value="",a&&URL.revokeObjectURL(a),n.cells[r][l]=URL.createObjectURL(o)};return(i,e)=>{const o=f("form-number-input"),l=f("form-row"),r=f("form-text-button"),a=f("form-sheet");return c(),S(X,{ref_key:"$el",ref:G,class:"image-gird-page"},{default:u(()=>[m(a,{class:"image-info-pane",onSubmit:e[4]||(e[4]=N(()=>{},["prevent"]))},{default:u(()=>[m(l,null,{default:u(()=>[F,m(o,{modelValue:d(t).imageGird.rowCount,"onUpdate:modelValue":e[0]||(e[0]=s=>d(t).imageGird.rowCount=s),precision:0},null,8,["modelValue"]),q,m(o,{modelValue:d(t).imageGird.columnCount,"onUpdate:modelValue":e[1]||(e[1]=s=>d(t).imageGird.columnCount=s),precision:0},null,8,["modelValue"])]),_:1}),m(l,null,{default:u(()=>[A,m(o,{modelValue:d(t).imageGird.imageWidth,"onUpdate:modelValue":e[2]||(e[2]=s=>d(t).imageGird.imageWidth=s),precision:0},null,8,["modelValue"]),D,m(o,{modelValue:d(t).imageGird.imageHeight,"onUpdate:modelValue":e[3]||(e[3]=s=>d(t).imageGird.imageHeight=s),precision:0},null,8,["modelValue"])]),_:1}),m(l,null,{default:u(()=>[m(r,{onClick:$},{default:u(()=>[E("生成")]),_:1})]),_:1})]),_:1}),g("div",J,[(c(!0),p(x,null,y(n.cells,(s,j)=>(c(),p("div",K,[(c(!0),p(x,null,y(s,(V,H)=>(c(),p("div",{class:"image-cell",onClick:ie=>L(H,j)},[V?(c(),p("img",{key:0,src:V},null,8,Z)):I("",!0)],8,Q))),256))]))),256)),g("input",{ref_key:"$cellInput",ref:C,accept:"image/*",type:"file",onInput:R,style:{display:"none"}},null,544)]),g("div",ee,[n.imageTarget?(c(),p("img",{key:0,class:"image-target",alt:"target",src:n.imageTarget},null,8,te)):I("",!0)])]),_:1},512)}}});const se=Y(oe,[["__scopeId","data-v-6dfdf5c4"]]);export{se as default};
